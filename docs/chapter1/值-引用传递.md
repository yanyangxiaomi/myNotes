## 值传递、引用传递

#### 3.1 值传递、引用传递

值传递与引用传递，在计算机领域是专有名词，属于函数调用时参数的求值策略，是对调用函数时，求值和传值的方式的描述，而非传递的内容的类型(内容指：是值类型还是引用类型，是值还是指针)。值类型/引用类型，是用于区分两种内存分配方式，值类型在调用栈上分配，引用类型是在堆上分配。值传递/引用传递描述参数求值策略，值类型/引用类型描述内存分配方式，两者之间无任何依赖或约束关系。

在函数调用过程中，调用方提供实参，这些实参可以是常量(1)、变量(x)、算式(x+1)、其他函数调用(other()),但是所有这些实参的形式，都统称为表达式。求值是指对这些表达式的简化并求解其值的过程。求值策略关注这些表达式在调用函数的过程中，求值的时机、值的形式的选取问题。求值策略的划分依据详见下表：

|          求值策略           | 求值时间 |        传值方式        |
| :-------------------------: | :------: | :--------------------: |
|    值传递(Pass by value)    |  调用前  | 值的结果(是原值的副本) |
| 引用传递(Pass by reference) |  调用前  |  原值(原始对象无副本)  |

因而值传递与引用传递的区别如下表：

|          | 值传递                 | 引用传递             |
| -------- | ---------------------- | -------------------- |
| 根本区别 | 会创建副本(Copy)       | 不创建副本           |
| 所以     | 函数中无法改变原始对象 | 函数中会改变原始对象 |


#### 3.2 Java是值传递吗
由上可知值传递与引用传递的区别是否改变原始对象，这个行为与参数类型是值类型还是引用类型无关。对于值传递，无论是值类型还是引用类型，都会在调用栈上创建一个副本，不同是，对于值类型而言，这个副本就是整个原始值的复制。而对于引用类型而言，由于引用类型的实例在堆中，在栈上只有它的一个引用（一般情况下是指针），其副本也只是这个引用的复制，而不是整个原始对象的复制。

这便引出了值类型和引用类型（这不是在说值传递）的最大区别：值类型用做参数会被复制，但是很多人误以为这个区别是值类型的特性。其实这是值传递带来的效果，和值类型本身没有关系。只是最终结果是这样。

**综上所述，对于Java的函数调用方式最准确的描述是：参数藉由值传递方式，传递的值是个引用。（句中两个“值”不是一个意思，第一个值是evaluation result，第二个值是value content）**

由于这个描述太绕，而且在字面上与Java总是传引用的事实冲突。于是对于Java，Python、Ruby、JavaScript等语言使用的这种求值策略，起了一个更贴切名字，叫*Call by sharing(共享传递)*。这个名字诞生于40年前。


>参考：[http://zhi.hu/6i1x](http://zhi.hu/6i1x)