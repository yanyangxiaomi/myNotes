## 数据库索引

#### 索引选择性

数据库查询优化器必须决定使用索引查找表中的某些行还是不使用索引才真正有意义。那么，何时使用数据库索引，合适不使用数据库索引呢？这是由数据库查询优化器根据索引选择性的值来决定，当索引选择性值很低时，不使用。

> 索引选择性计算：
>
> 指数的选择性 = 基数 / (记录数) * 100%
>
> 基数：指列中唯一值的个数
>
> 记录数：表中的总记录数

当索引选择性值很低时，为什么说低选择性意味着使用索引不是一个好主意，假设我们想要运行一个查询，该查询将找到表中所有女性的名字 。如果我们在10,000行的表中搜索所有女性行，那么50％的行很可能是女性，因为实际上只有两个可能的值 - 男性和女性。假设50％的行确实是女性，那么这意味着我们必须访问索引5000次才能找到所有的女性行。访问索引需要时间，并消耗资源。 如果我们访问索引5000次，那么直接访问该表并进行全表扫描实际上会更快。因此，您可以看到查询优化器使用选择性值来确定使用索引或直接读取表是否更有效。

什么选择性值决定是否使用索引？ 

从一个数据库到另一个数据库的索引选择性值的确切值是不同的。当然，高选择性值意味着绝对应该使用索引。例如，如果我们处理的选择性为100％的列，则该列中的所有值都是唯一的。这意味着如果查询只搜索其中一个值，那么使用索引会更有意义，因为它会比冒全表扫描的风险更有效 - 如果全表扫描，这是最糟糕的情况直接没有先咨询指数。